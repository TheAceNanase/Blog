<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>NoSQL入门 - 💗Nanase</title><meta name="Description" content="NoSQL入门"><meta property="og:title" content="NoSQL入门" />
<meta property="og:description" content="NoSQL入门" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.nishinonanase.xyz/nosql%E5%85%A5%E9%97%A8/" />
<meta property="og:image" content="http://www.nishinonanase.xyz/logo.png"/>
<meta property="article:published_time" content="2016-12-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-12-15T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://www.nishinonanase.xyz/logo.png"/>

<meta name="twitter:title" content="NoSQL入门"/>
<meta name="twitter:description" content="NoSQL入门"/>
<meta name="application-name" content="💗Nanase">
<meta name="apple-mobile-web-app-title" content="💗Nanase"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://www.nishinonanase.xyz/nosql%E5%85%A5%E9%97%A8/" /><link rel="prev" href="http://www.nishinonanase.xyz/mysql%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" /><link rel="next" href="http://www.nishinonanase.xyz/redis%E6%8C%81%E4%B9%85%E5%8C%96/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "NoSQL入门",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/www.nishinonanase.xyz\/nosql%E5%85%A5%E9%97%A8\/"
        },"genre": "posts","keywords": "数据库, Nosql","wordcount":  6846 ,
        "url": "http:\/\/www.nishinonanase.xyz\/nosql%E5%85%A5%E9%97%A8\/","datePublished": "2016-12-15T00:00:00+00:00","dateModified": "2016-12-15T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Nanase","logo": "http:\/\/www.nishinonanase.xyz\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Nanase"
            },"description": "NoSQL入门"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="💗Nanase">💗Nanase</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 🍑全部文章 </a><a class="menu-item" href="/tags/"> 🍊标签 </a><a class="menu-item" href="/categories/"> 🍓分类 </a><a class="menu-item" href="/about/"> 🥝关于 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="💗Nanase">💗Nanase</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">🍑全部文章</a><a class="menu-item" href="/tags/" title="">🍊标签</a><a class="menu-item" href="/categories/" title="">🍓分类</a><a class="menu-item" href="/about/" title="">🥝关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">NoSQL入门</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://www.nishinonanase.xyz/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Nanase</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA/"><i class="far fa-folder fa-fw"></i>基础理论</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2016-12-15">2016-12-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 6846 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 14 分钟&nbsp;<span id="/nosql%E5%85%A5%E9%97%A8/" class="leancloud_visitors" data-flag-title="NoSQL入门">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#nosql入门">NoSQL入门</a>
          <ul>
            <li><a href="#nosql概述">NoSQL概述</a></li>
            <li><a href="#redis概述">Redis概述</a>
              <ul>
                <li><a href="#redis简介">Redis简介</a></li>
                <li><a href="#redis的应用场景">Redis的应用场景</a></li>
                <li><a href="#redis的安装和配置">Redis的安装和配置</a></li>
                <li><a href="#redis的服务器和客户端">Redis的服务器和客户端</a></li>
                <li><a href="#在python程序中使用redis">在Python程序中使用Redis</a></li>
              </ul>
            </li>
            <li><a href="#mongodb概述">MongoDB概述</a>
              <ul>
                <li><a href="#mongodb简介">MongoDB简介</a></li>
                <li><a href="#mongodb的安装和配置">MongoDB的安装和配置</a></li>
                <li><a href="#mongodb基本概念">MongoDB基本概念</a></li>
                <li><a href="#通过shell操作mongodb">通过Shell操作MongoDB</a></li>
                <li><a href="#在python程序中操作mongodb">在Python程序中操作MongoDB</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="nosql入门">NoSQL入门</h2>
<h3 id="nosql概述">NoSQL概述</h3>
<p>如今，大多数的计算机系统（包括服务器、PC、移动设备等）都会产生庞大的数据量。其实，早在2012年的时候，全世界每天产生的数据量就达到了2.5EB（艾字节，$$1EB\approx10^{18}B$$）。这些数据有很大一部分是由关系型数据库来存储和管理的。 早在1970年，E.F.Codd发表了论述关系型数据库的著名论文“<em>A relational model of data for large shared data banks</em>”，这篇文章奠定了关系型数据库的基础并在接下来的数十年时间内产生了深远的影响。实践证明，关系型数据库是实现数据持久化最为重要的方式，它也是大多数应用在选择持久化方案时的首选技术。</p>
<p>NoSQL是一项全新的数据库革命性运动，虽然它的历史可以追溯到1998年，但是NoSQL真正深入人心并得到广泛的应用是在进入大数据时候以后，业界普遍认为NoSQL是更适合大数据存储的技术方案，这才使得NoSQL的发展达到了前所未有的高度。2012年《纽约时报》的一篇专栏中写到，大数据时代已经降临，在商业、经济及其他领域中，决策将不再基于经验和直觉而是基于数据和分析而作出。事实上，在天文学、气象学、基因组学、生物学、社会学、互联网搜索引擎、金融、医疗、社交网络、电子商务等诸多领域，由于数据过于密集和庞大，在数据的分析和处理上也遇到了前所未有的限制和阻碍，这一切都使得对大数据处理技术的研究被提升到了新的高度，也使得各种NoSQL的技术方案进入到了公众的视野。</p>
<p>NoSQL数据库按照其存储类型可以大致分为以下几类：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>部分代表</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>列族数据库</td>
<td>HBase<br>Cassandra<br>Hypertable</td>
<td>顾名思义是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的I/O优势，适合于批量数据处理和即时查询。</td>
</tr>
<tr>
<td>文档数据库</td>
<td>MongoDB<br>CouchDB<br>ElasticSearch</td>
<td>文档数据库一般用类JSON格式存储数据，存储的内容是文档型的。这样也就有机会对某些字段建立索引，实现关系数据库的某些功能，但不提供对参照完整性和分布事务的支持。</td>
</tr>
<tr>
<td>KV数据库</td>
<td>DynamoDB<br>Redis<br>LevelDB</td>
<td>可以通过key快速查询到其value，有基于内存和基于磁盘两种实现方案。</td>
</tr>
<tr>
<td>图数据库</td>
<td>Neo4J<br>FlockDB<br>JanusGraph</td>
<td>使用图结构进行语义查询的数据库，它使用节点、边和属性来表示和存储数据。图数据库从设计上，就可以简单快速的检索难以在关系系统中建模的复杂层次结构。</td>
</tr>
<tr>
<td>对象数据库</td>
<td>db4o<br>Versant</td>
<td>通过类似面向对象语言的语法操作数据库，通过对象的方式存取数据。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>说明：想了解更多的NoSQL数据库，可以访问<a href="http://nosql-database.org/">http://nosql-database.org/</a>。</p>
</blockquote>
<h3 id="redis概述">Redis概述</h3>
<p>Redis是一种基于键值对的NoSQL数据库，它提供了对多种数据类型（字符串、哈希、列表、集合、有序集合、位图等）的支持，能够满足很多应用场景的需求。Redis将数据放在内存中，因此读写性能是非常惊人的。与此同时，Redis也提供了持久化机制，能够将内存中的数据保存到硬盘上，在发生意外状况时数据也不会丢掉。此外，Redis还支持键过期、地理信息运算、发布订阅、事务、管道、Lua脚本扩展等功能，总而言之，Redis的功能和性能都非常强大，如果项目中要实现高速缓存和消息队列这样的服务，直接交给Redis就可以了。目前，国内外很多著名的企业和商业项目都使用了Redis，包括：Twitter、Github、StackOverflow、新浪微博、百度、优酷土豆、美团、小米、唯品会等。</p>
<h4 id="redis简介">Redis简介</h4>
<p>2008年，一个名为Salvatore Sanfilippo的程序员为他开发的LLOOGG项目定制了专属的数据库（因为之前他无论怎样优化MySQL，系统性能已经无法再提升了），这项工作的成果就是Redis的初始版本。后来他将Redis的代码放到了全球最大的代码托管平台<a href="https://github.com/antirez/redis" target="_blank" rel="noopener noreffer">Github</a>，从那以后，Redis引发了大量开发者的好评和关注，继而有数百人参与了Redis的开发和维护，这使得Redis的功能越来越强大和性能越来越好。</p>
<p>Redis是REmote DIctionary Server的缩写，它是一个用ANSI C编写的高性能的key-value存储系统，与其他的key-value存储系统相比，Redis有以下一些特点（也是优点）：</p>
<ul>
<li>Redis的读写性能极高，并且有丰富的特性（发布/订阅、事务、通知等）。</li>
<li>Redis支持数据的持久化（RDB和AOF两种方式），可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用。</li>
<li>Redis支持多种数据类型，包括：string、hash、list、set，zset、bitmap、hyperloglog等。</li>
<li>Redis支持主从复制（实现读写分析）以及哨兵模式（监控master是否宕机并自动调整配置）。</li>
<li>Redis支持分布式集群，可以很容易的通过水平扩展来提升系统的整体性能。</li>
<li>Redis基于TCP提供的可靠传输服务进行通信，很多编程语言都提供了Redis客户端支持。</li>
</ul>
<h4 id="redis的应用场景">Redis的应用场景</h4>
<ol>
<li>高速缓存  - 将不常变化但又经常被访问的热点数据放到Redis数据库中，可以大大降低关系型数据库的压力，从而提升系统的响应性能。</li>
<li>排行榜 - 很多网站都有排行榜功能，利用Redis中的列表和有序集合可以非常方便的构造各种排行榜系统。</li>
<li>商品秒杀/投票点赞 - Redis提供了对计数操作的支持，网站上常见的秒杀、点赞等功能都可以利用Redis的计数器通过+1或-1的操作来实现，从而避免了使用关系型数据的<code>update</code>操作。</li>
<li>分布式锁 - 利用Redis可以跨多台服务器实现分布式锁（类似于线程锁，但是能够被多台机器上的多个线程或进程共享）的功能，用于实现一个阻塞式操作。</li>
<li>消息队列 - 消息队列和高速缓存一样，是一个大型网站不可缺少的基础服务，可以实现业务解耦和非实时业务削峰等特性，这些我们都会在后面的项目中为大家展示。</li>
</ol>
<h4 id="redis的安装和配置">Redis的安装和配置</h4>
<p>可以使用Linux系统的包管理工具（如yum）来安装Redis，也可以通过在Redis的<a href="https://redis.io/" target="_blank" rel="noopener noreffer">官方网站</a>下载Redis的源代码，解压缩解归档之后通过make工具对源代码进行构建并安装，在更新这篇文档时，Redis官方提供的最新稳定版本是<a href="http://download.redis.io/releases/redis-5.0.4.tar.gz" target="_blank" rel="noopener noreffer">Redis 5.0.4</a>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">wget http://download.redis.io/releases/redis-5.0.4.tar.gz
gunzip redis-5.0.4.tar.gz
tar -xvf redis-5.0.4.tar
<span class="nb">cd</span> redis-5.0.4
make <span class="o">&amp;&amp;</span> make install
</code></pre></td></tr></table>
</div>
</div><p>在redis源代码目录下有一个名为redis.conf的配置文件，我们可以先查看一下该文件。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">vim redis.conf
</code></pre></td></tr></table>
</div>
</div><p>配置将Redis服务绑定到指定的IP地址和端口。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-bind-and-port.png"
        data-srcset="./res/redis-bind-and-port.png, ./res/redis-bind-and-port.png 1.5x, ./res/redis-bind-and-port.png 2x"
        data-sizes="auto"
        alt="./res/redis-bind-and-port.png"
        title="./res/redis-bind-and-port.png" /></p>
<p>配置底层有多少个数据库。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-databases.png"
        data-srcset="./res/redis-databases.png, ./res/redis-databases.png 1.5x, ./res/redis-databases.png 2x"
        data-sizes="auto"
        alt="./res/redis-databases.png"
        title="./res/redis-databases.png" /></p>
<p>配置Redis的持久化机制 - RDB。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-rdb-1.png"
        data-srcset="./res/redis-rdb-1.png, ./res/redis-rdb-1.png 1.5x, ./res/redis-rdb-1.png 2x"
        data-sizes="auto"
        alt="./res/redis-rdb-1.png"
        title="./res/redis-rdb-1.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-rdb-3.png"
        data-srcset="./res/redis-rdb-3.png, ./res/redis-rdb-3.png 1.5x, ./res/redis-rdb-3.png 2x"
        data-sizes="auto"
        alt="./res/redis-rdb-3.png"
        title="./res/redis-rdb-3.png" /></p>
<p>配置Redis的持久化机制 - AOF。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-aof.png"
        data-srcset="./res/redis-aof.png, ./res/redis-aof.png 1.5x, ./res/redis-aof.png 2x"
        data-sizes="auto"
        alt="./res/redis-aof.png"
        title="./res/redis-aof.png" /></p>
<p>配置访问Redis服务器的验证口令。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-security.png"
        data-srcset="./res/redis-security.png, ./res/redis-security.png 1.5x, ./res/redis-security.png 2x"
        data-sizes="auto"
        alt="./res/redis-security.png"
        title="./res/redis-security.png" /></p>
<p>配置Redis的主从复制，通过主从复制可以实现读写分离。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-replication.png"
        data-srcset="./res/redis-replication.png, ./res/redis-replication.png 1.5x, ./res/redis-replication.png 2x"
        data-sizes="auto"
        alt="./res/redis-replication.png"
        title="./res/redis-replication.png" /></p>
<p>配置慢查询。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-slow-logs.png"
        data-srcset="./res/redis-slow-logs.png, ./res/redis-slow-logs.png 1.5x, ./res/redis-slow-logs.png 2x"
        data-sizes="auto"
        alt="./res/redis-slow-logs.png"
        title="./res/redis-slow-logs.png" /></p>
<p>上面这些内容就是Redis的基本配置，如果你对上面的内容感到困惑也没有关系，先把Redis用起来再回头去推敲这些内容就行了。如果想找一些参考书，<a href="https://item.jd.com/12121730.html" target="_blank" rel="noopener noreffer">《Redis开发与运维》</a>是一本不错的入门读物，而<a href="https://item.jd.com/11791607.html" target="_blank" rel="noopener noreffer">《Redis实战》</a>是不错的进阶读物。</p>
<h4 id="redis的服务器和客户端">Redis的服务器和客户端</h4>
<p>接下来启动Redis服务器，下面的方式将以默认的配置启动Redis服务。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">redis-server
</code></pre></td></tr></table>
</div>
</div><p>如果希望修改Redis的配置（如端口、认证口令、持久化方式等），可以通过下面两种方式。</p>
<p>方式一：通过参数指定认证口令和AOF持久化方式。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">redis-server --requirepass yourpass --appendonly yes
</code></pre></td></tr></table>
</div>
</div><p>方式二：通过指定的配置文件来修改Redis的配置。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">redis-server /root/redis-5.0.4/redis.conf
</code></pre></td></tr></table>
</div>
</div><p>下面我们使用第一种方式来启动Redis并将其置于后台运行，将Redis产生的输出重定向到名为redis.log的文件中。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">redis-server --requirepass yourpass &gt; redis.log <span class="p">&amp;</span>
</code></pre></td></tr></table>
</div>
</div><p>可以通过ps或者netstat来检查Redis服务器是否启动成功。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">ps -ef <span class="p">|</span> grep redis-server
netstat -nap <span class="p">|</span> grep redis-server
</code></pre></td></tr></table>
</div>
</div><p>接下来，我们尝试用Redis客户端去连接服务器。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">redis-cli
127.0.0.1:6379&gt; auth yourpass
OK
127.0.0.1:6379&gt; ping
PONG
127.0.0.1:6379&gt;
</code></pre></td></tr></table>
</div>
</div><p>Redis有着非常丰富的数据类型，也有很多的命令来操作这些数据，具体的内容可以查看<a href="http://redisdoc.com/" target="_blank" rel="noopener noreffer">Redis命令参考</a>，在这个网站上，除了Redis的命令参考，还有Redis的详细文档，其中包括了通知、事务、主从复制、持久化、哨兵、集群等内容。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./res/redis-data-types.png"
        data-srcset="./res/redis-data-types.png, ./res/redis-data-types.png 1.5x, ./res/redis-data-types.png 2x"
        data-sizes="auto"
        alt="./res/redis-data-types.png"
        title="./res/redis-data-types.png" /></p>
<blockquote>
<p>说明：上面的插图来自付磊和张益军先生编著的《Redis开发与运维》一书。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">127.0.0.1:6379&gt; <span class="nb">set</span> username admin
OK
127.0.0.1:6379&gt; get username
<span class="s2">&#34;admin&#34;</span>
127.0.0.1:6379&gt; <span class="nb">set</span> password <span class="s2">&#34;123456&#34;</span> ex <span class="m">300</span>
OK
127.0.0.1:6379&gt; get password
<span class="s2">&#34;123456&#34;</span>
127.0.0.1:6379&gt; ttl username
<span class="o">(</span>integer<span class="o">)</span> -1
127.0.0.1:6379&gt; ttl password
<span class="o">(</span>integer<span class="o">)</span> <span class="m">286</span>
127.0.0.1:6379&gt; hset stu1 name hao
<span class="o">(</span>integer<span class="o">)</span> <span class="m">0</span>
127.0.0.1:6379&gt; hset stu1 age <span class="m">38</span>
<span class="o">(</span>integer<span class="o">)</span> <span class="m">1</span>
127.0.0.1:6379&gt; hset stu1 gender male
<span class="o">(</span>integer<span class="o">)</span> <span class="m">1</span>
127.0.0.1:6379&gt; hgetall stu1
1<span class="o">)</span> <span class="s2">&#34;name&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;hao&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;age&#34;</span>
4<span class="o">)</span> <span class="s2">&#34;38&#34;</span>
5<span class="o">)</span> <span class="s2">&#34;gender&#34;</span>
6<span class="o">)</span> <span class="s2">&#34;male&#34;</span>
127.0.0.1:6379&gt; hvals stu1
1<span class="o">)</span> <span class="s2">&#34;hao&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;38&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;male&#34;</span>
127.0.0.1:6379&gt; hmset stu2 name wang age <span class="m">18</span> gender female tel <span class="m">13566778899</span>
OK
127.0.0.1:6379&gt; hgetall stu2
1<span class="o">)</span> <span class="s2">&#34;name&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;wang&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;age&#34;</span>
4<span class="o">)</span> <span class="s2">&#34;18&#34;</span>
5<span class="o">)</span> <span class="s2">&#34;gender&#34;</span>
6<span class="o">)</span> <span class="s2">&#34;female&#34;</span>
7<span class="o">)</span> <span class="s2">&#34;tel&#34;</span>
8<span class="o">)</span> <span class="s2">&#34;13566778899&#34;</span>
127.0.0.1:6379&gt; lpush nums <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span>
<span class="o">(</span>integer<span class="o">)</span> <span class="m">5</span>
127.0.0.1:6379&gt; lrange nums <span class="m">0</span> -1
1<span class="o">)</span> <span class="s2">&#34;5&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;4&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;3&#34;</span>
4<span class="o">)</span> <span class="s2">&#34;2&#34;</span>
5<span class="o">)</span> <span class="s2">&#34;1&#34;</span>
127.0.0.1:6379&gt; lpop nums
<span class="s2">&#34;5&#34;</span>
127.0.0.1:6379&gt; lpop nums
<span class="s2">&#34;4&#34;</span>
127.0.0.1:6379&gt; rpop nums
<span class="s2">&#34;1&#34;</span>
127.0.0.1:6379&gt; rpop nums
<span class="s2">&#34;2&#34;</span>
127.0.0.1:6379&gt; sadd fruits apple banana orange apple grape grape
<span class="o">(</span>integer<span class="o">)</span> <span class="m">4</span>
127.0.0.1:6379&gt; scard fruits
<span class="o">(</span>integer<span class="o">)</span> <span class="m">4</span>
127.0.0.1:6379&gt; smembers fruits
1<span class="o">)</span> <span class="s2">&#34;grape&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;orange&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;banana&#34;</span>
4<span class="o">)</span> <span class="s2">&#34;apple&#34;</span>
127.0.0.1:6379&gt; sismember fruits apple
<span class="o">(</span>integer<span class="o">)</span> <span class="m">1</span>
127.0.0.1:6379&gt; sismember fruits durian
<span class="o">(</span>integer<span class="o">)</span> <span class="m">0</span>
127.0.0.1:6379&gt; sadd nums1 <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span>
<span class="o">(</span>integer<span class="o">)</span> <span class="m">5</span>
127.0.0.1:6379&gt; sadd nums2 <span class="m">2</span> <span class="m">4</span> <span class="m">6</span> <span class="m">8</span>
<span class="o">(</span>integer<span class="o">)</span> <span class="m">4</span>
127.0.0.1:6379&gt; sinter nums1 nums2
1<span class="o">)</span> <span class="s2">&#34;2&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;4&#34;</span>
127.0.0.1:6379&gt; sunion nums1 nums2
1<span class="o">)</span> <span class="s2">&#34;1&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;2&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;3&#34;</span>
4<span class="o">)</span> <span class="s2">&#34;4&#34;</span>
5<span class="o">)</span> <span class="s2">&#34;5&#34;</span>
6<span class="o">)</span> <span class="s2">&#34;6&#34;</span>
7<span class="o">)</span> <span class="s2">&#34;8&#34;</span>
127.0.0.1:6379&gt; sdiff nums1 nums2
1<span class="o">)</span> <span class="s2">&#34;1&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;3&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;5&#34;</span>
127.0.0.1:6379&gt; zadd topsinger <span class="m">5234</span> zhangxy <span class="m">1978</span> chenyx <span class="m">2235</span> zhoujl <span class="m">3520</span> xuezq
<span class="o">(</span>integer<span class="o">)</span> <span class="m">4</span>
127.0.0.1:6379&gt; zrange topsinger <span class="m">0</span> -1 withscores
1<span class="o">)</span> <span class="s2">&#34;chenyx&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;1978&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;zhoujl&#34;</span>
4<span class="o">)</span> <span class="s2">&#34;2235&#34;</span>
5<span class="o">)</span> <span class="s2">&#34;xuezq&#34;</span>
6<span class="o">)</span> <span class="s2">&#34;3520&#34;</span>
7<span class="o">)</span> <span class="s2">&#34;zhangxy&#34;</span>
8<span class="o">)</span> <span class="s2">&#34;5234&#34;</span>
127.0.0.1:6379&gt; zrevrange topsinger <span class="m">0</span> -1
1<span class="o">)</span> <span class="s2">&#34;zhangxy&#34;</span>
2<span class="o">)</span> <span class="s2">&#34;xuezq&#34;</span>
3<span class="o">)</span> <span class="s2">&#34;zhoujl&#34;</span>
4<span class="o">)</span> <span class="s2">&#34;chenyx&#34;</span>
127.0.0.1:6379&gt; geoadd pois 116.39738549206541 39.90862689286386 tiananmen 116.27172936413572 39.99
<span class="m">135172904494</span> yiheyuan 117.27766503308104 40.65332064313784 gubeishuizhen
<span class="o">(</span>integer<span class="o">)</span> <span class="m">3</span>
127.0.0.1:6379&gt; geodist pois tiananmen gubeishuizhen km
<span class="s2">&#34;111.5333&#34;</span>
127.0.0.1:6379&gt; geodist pois tiananmen yiheyuan km
<span class="s2">&#34;14.1230&#34;</span>
127.0.0.1:6379&gt; georadius pois 116.86499108288572 40.40149669363615 <span class="m">50</span> km withdist
1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">&#34;gubeishuizhen&#34;</span>
   2<span class="o">)</span> <span class="s2">&#34;44.7408&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="在python程序中使用redis">在Python程序中使用Redis</h4>
<p>可以使用pip安装redis模块。redis模块的核心是名为Redis的类，该类的对象代表一个Redis客户端，通过该客户端可以向Redis服务器发送命令并获取执行的结果。上面我们在Redis客户端中使用的命令基本上就是Redis对象可以接收的消息，所以如果了解了Redis的命令就可以在Python中玩转Redis。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">pip3 install redis
python3
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">redis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;1.2.3.4&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;yourpass&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;admin&#39;</span><span class="p">)</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s1">&#39;student&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;hao&#39;</span><span class="p">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="s1">&#39;student&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="mi">38</span><span class="p">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="sa">b</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;student&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<span class="sa">b</span><span class="s1">&#39;admin&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="s1">&#39;student&#39;</span><span class="p">)</span>
<span class="p">{</span><span class="sa">b</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;hao&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;38&#39;</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="mongodb概述">MongoDB概述</h3>
<h4 id="mongodb简介">MongoDB简介</h4>
<p>MongoDB是2009年问世的一个面向文档的数据库管理系统，由C++语言编写，旨在为Web应用提供可扩展的高性能数据存储解决方案。虽然在划分类别的时候后，MongoDB被认为是NoSQL的产品，但是它更像一个介于关系数据库和非关系数据库之间的产品，在非关系数据库中它功能最丰富，最像关系数据库。</p>
<p>MongoDB将数据存储为一个文档，一个文档由一系列的“键值对”组成，其文档类似于JSON对象，但是MongoDB对JSON进行了二进制处理（能够更快的定位key和value），因此其文档的存储格式称为BSON。关于JSON和BSON的差别大家可以看看MongoDB官方网站的文章<a href="https://www.mongodb.com/json-and-bson" target="_blank" rel="noopener noreffer">《JSON and BSON》</a>。</p>
<p>目前，MongoDB已经提供了对Windows、MacOS、Linux、Solaris等多个平台的支持，而且也提供了多种开发语言的驱动程序，Python当然是其中之一。</p>
<h4 id="mongodb的安装和配置">MongoDB的安装和配置</h4>
<p>可以从MongoDB的<a href="https://www.mongodb.com/download-center#community" target="_blank" rel="noopener noreffer">官方下载链接</a>下载MongoDB，官方为Windows系统提供了一个Installer程序，而Linux和MacOS则提供了压缩文件。下面简单说一下Linux系统如何安装和配置MongoDB。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-amazon-3.6.5.tgz
gunzip mongodb-linux-x86_64-amazon-3.6.5.tgz
mkdir mongodb-3.6.5
tar -xvf mongodb-linux-x86_64-amazon-3.6.5.tar --strip-components <span class="m">1</span> -C mongodb-3.6.5/
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:~/mongodb-3.6.5/bin
mkdir -p /data/db
mongod --bind_ip 172.18.61.250

2018-06-03T18:03:28.232+0800 I CONTROL  <span class="o">[</span>initandlisten<span class="o">]</span> MongoDB starting : <span class="nv">pid</span><span class="o">=</span><span class="m">1163</span> <span class="nv">port</span><span class="o">=</span><span class="m">27017</span> <span class="nv">dbpath</span><span class="o">=</span>/data/db 64-bit <span class="nv">host</span><span class="o">=</span>iZwz97tbgo9lkabnat2lo8Z
2018-06-03T18:03:28.232+0800 I CONTROL  <span class="o">[</span>initandlisten<span class="o">]</span> db version v3.6.5
2018-06-03T18:03:28.232+0800 I CONTROL  <span class="o">[</span>initandlisten<span class="o">]</span> git version: a20ecd3e3a174162052ff99913bc2ca9a839d618
2018-06-03T18:03:28.232+0800 I CONTROL  <span class="o">[</span>initandlisten<span class="o">]</span> OpenSSL version: OpenSSL 1.0.0-fips29 Mar <span class="m">2010</span>
...
2018-06-03T18:03:28.945+0800 I NETWORK  <span class="o">[</span>initandlisten<span class="o">]</span> waiting <span class="k">for</span> connections on port <span class="m">27017</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>说明：上面的操作中，export命令是设置PATH环境变量，这样可以在任意路径下执行mongod来启动MongoDB服务器。MongoDB默认保存数据的路径是/data/db目录，为此要提前创建该目录。此外，在使用mongod启动MongoDB服务器时，&ndash;bind_ip参数用来将服务绑定到指定的IP地址，也可以用&ndash;port参数来指定端口，默认端口为27017。</p>
</blockquote>
<h4 id="mongodb基本概念">MongoDB基本概念</h4>
<p>我们通过与关系型数据库进行对照的方式来说明MongoDB中的一些概念。</p>
<table>
<thead>
<tr>
<th>SQL</th>
<th>MongoDB</th>
<th>解释（SQL/MongoDB）</th>
</tr>
</thead>
<tbody>
<tr>
<td>database</td>
<td>database</td>
<td>数据库/数据库</td>
</tr>
<tr>
<td>table</td>
<td>collection</td>
<td>二维表/集合</td>
</tr>
<tr>
<td>row</td>
<td>document</td>
<td>记录（行）/文档</td>
</tr>
<tr>
<td>column</td>
<td>field</td>
<td>字段（列）/域</td>
</tr>
<tr>
<td>index</td>
<td>index</td>
<td>索引/索引</td>
</tr>
<tr>
<td>table joins</td>
<td>&mdash;</td>
<td>表连接/嵌套文档</td>
</tr>
<tr>
<td>primary key</td>
<td>primary key</td>
<td>主键/主键（<code>_id</code>字段）</td>
</tr>
</tbody>
</table>
<h4 id="通过shell操作mongodb">通过Shell操作MongoDB</h4>
<p>启动服务器后可以使用交互式环境跟服务器通信，如下所示。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">mongo --host 172.18.61.250

MongoDB shell version v3.6.5
connecting to: mongodb://172.18.61.250:27017/
</code></pre></td></tr></table>
</div>
</div><ol>
<li>
<p>查看、创建和删除数据库。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="o">&gt;</span> <span class="c1">// 显示所有数据库
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">show</span> <span class="nx">dbs</span>
<span class="nx">admin</span>   <span class="mf">0.000</span><span class="nx">GB</span>
<span class="nx">config</span>  <span class="mf">0.000</span><span class="nx">GB</span>
<span class="nx">local</span>   <span class="mf">0.000</span><span class="nx">GB</span>
<span class="o">&gt;</span> <span class="c1">// 创建并切换到school数据库
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">use</span> <span class="nx">school</span>
<span class="nx">switched</span> <span class="nx">to</span> <span class="nx">db</span> <span class="nx">school</span>
<span class="o">&gt;</span> <span class="c1">// 删除当前数据库
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">dropDatabase</span><span class="p">()</span>
<span class="p">{</span> <span class="s2">&#34;ok&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">}</span>
<span class="o">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建、删除和查看集合。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="o">&gt;</span> <span class="c1">// 创建并切换到school数据库
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">use</span> <span class="nx">school</span>
<span class="nx">switched</span> <span class="nx">to</span> <span class="nx">db</span> <span class="nx">school</span>
<span class="o">&gt;</span> <span class="c1">// 创建colleges集合
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">createCollection</span><span class="p">(</span><span class="s1">&#39;colleges&#39;</span><span class="p">)</span>
<span class="p">{</span> <span class="s2">&#34;ok&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 创建students集合
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">createCollection</span><span class="p">(</span><span class="s1">&#39;students&#39;</span><span class="p">)</span>
<span class="p">{</span> <span class="s2">&#34;ok&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 查看所有集合
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">show</span> <span class="nx">collections</span>
<span class="nx">colleges</span>
<span class="nx">students</span>
<span class="o">&gt;</span> <span class="c1">// 删除colleges集合
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">colleges</span><span class="p">.</span><span class="nx">drop</span><span class="p">()</span>
<span class="kc">true</span>
<span class="o">&gt;</span> 
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>说明：在MongoDB中插入文档时如果集合不存在会自动创建集合，所以也可以按照下面的方式通过创建文档来创建集合。</p>
</blockquote>
</li>
<li>
<p>文档的CRUD操作。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="o">&gt;</span> <span class="c1">// 向students集合插入文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">stuid</span><span class="o">:</span> <span class="mi">1001</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;骆昊&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">38</span><span class="p">})</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nInserted&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
<span class="o">&gt;</span> <span class="c1">// 向students集合插入文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">stuid</span><span class="o">:</span> <span class="mi">1002</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;王大锤&#39;</span><span class="p">,</span> <span class="nx">tel</span><span class="o">:</span> <span class="s1">&#39;13012345678&#39;</span><span class="p">,</span> <span class="nx">gender</span><span class="o">:</span> <span class="s1">&#39;男&#39;</span><span class="p">})</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nInserted&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
<span class="o">&gt;</span> <span class="c1">// 查看所有文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
<span class="p">{</span> <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c72e006ad854460ee70b&#34;</span><span class="p">),</span> <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1001</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;骆昊&#34;</span><span class="p">,</span> <span class="s2">&#34;age&#34;</span> <span class="o">:</span> <span class="mi">38</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c790006ad854460ee70c&#34;</span><span class="p">),</span> <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1002</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;王大锤&#34;</span><span class="p">,</span> <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13012345678&#34;</span><span class="p">,</span> <span class="s2">&#34;gender&#34;</span> <span class="o">:</span> <span class="s2">&#34;男&#34;</span> <span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 更新stuid为1001的文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span><span class="nx">stuid</span><span class="o">:</span> <span class="mi">1001</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;$set&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">tel</span><span class="o">:</span> <span class="s1">&#39;13566778899&#39;</span><span class="p">,</span> <span class="nx">gender</span><span class="o">:</span> <span class="s1">&#39;男&#39;</span><span class="p">}})</span>
<span class="nx">WriteResult</span><span class="p">({</span> <span class="s2">&#34;nMatched&#34;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;nUpserted&#34;</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;nModified&#34;</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})</span>
<span class="o">&gt;</span> <span class="c1">// 插入或更新stuid为1003的文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span><span class="nx">stuid</span><span class="o">:</span> <span class="mi">1003</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;$set&#39;</span><span class="o">:</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;白元芳&#39;</span><span class="p">,</span> <span class="nx">tel</span><span class="o">:</span> <span class="s1">&#39;13022223333&#39;</span><span class="p">,</span> <span class="nx">gender</span><span class="o">:</span> <span class="s1">&#39;男&#39;</span><span class="p">}},</span>  <span class="nx">upsert</span><span class="o">=</span><span class="kc">true</span><span class="p">)</span>
<span class="nx">WriteResult</span><span class="p">({</span>
        <span class="s2">&#34;nMatched&#34;</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&#34;nUpserted&#34;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&#34;nModified&#34;</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c92dd185894d7283efab&#34;</span><span class="p">)</span>
<span class="p">})</span>
<span class="o">&gt;</span> <span class="c1">// 查询所有文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">pretty</span><span class="p">()</span>
<span class="p">{</span>
        <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c72e006ad854460ee70b&#34;</span><span class="p">),</span>
        <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1001</span><span class="p">,</span>
        <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;骆昊&#34;</span><span class="p">,</span>
        <span class="s2">&#34;age&#34;</span> <span class="o">:</span> <span class="mi">38</span><span class="p">,</span>
        <span class="s2">&#34;gender&#34;</span> <span class="o">:</span> <span class="s2">&#34;男&#34;</span><span class="p">,</span>
        <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13566778899&#34;</span>
<span class="p">}</span>
<span class="p">{</span>
        <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c790006ad854460ee70c&#34;</span><span class="p">),</span>
        <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1002</span><span class="p">,</span>
        <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;王大锤&#34;</span><span class="p">,</span>
        <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13012345678&#34;</span><span class="p">,</span>
        <span class="s2">&#34;gender&#34;</span> <span class="o">:</span> <span class="s2">&#34;男&#34;</span>
<span class="p">}</span>
<span class="p">{</span>
        <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c92dd185894d7283efab&#34;</span><span class="p">),</span>
        <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1003</span><span class="p">,</span>
        <span class="s2">&#34;gender&#34;</span> <span class="o">:</span> <span class="s2">&#34;男&#34;</span><span class="p">,</span>
        <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;白元芳&#34;</span><span class="p">,</span>
        <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13022223333&#34;</span>
<span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 查询stuid大于1001的文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">stuid</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;$gt&#39;</span><span class="o">:</span> <span class="mi">1001</span><span class="p">}}).</span><span class="nx">pretty</span><span class="p">()</span>
<span class="p">{</span>
        <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c790006ad854460ee70c&#34;</span><span class="p">),</span>
        <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1002</span><span class="p">,</span>
        <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;王大锤&#34;</span><span class="p">,</span>
        <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13012345678&#34;</span><span class="p">,</span>
        <span class="s2">&#34;gender&#34;</span> <span class="o">:</span> <span class="s2">&#34;男&#34;</span>
<span class="p">}</span>
<span class="p">{</span>
        <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c92dd185894d7283efab&#34;</span><span class="p">),</span>
        <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1003</span><span class="p">,</span>
        <span class="s2">&#34;gender&#34;</span> <span class="o">:</span> <span class="s2">&#34;男&#34;</span><span class="p">,</span>
        <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;白元芳&#34;</span><span class="p">,</span>
        <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13022223333&#34;</span>
<span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 查询stuid大于1001的文档只显示name和tel字段
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">stuid</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;$gt&#39;</span><span class="o">:</span> <span class="mi">1001</span><span class="p">}},</span> <span class="p">{</span><span class="nx">_id</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">tel</span><span class="o">:</span> <span class="mi">1</span><span class="p">}).</span><span class="nx">pretty</span><span class="p">()</span>
<span class="p">{</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;王大锤&#34;</span><span class="p">,</span> <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13012345678&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;白元芳&#34;</span><span class="p">,</span> <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13022223333&#34;</span> <span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 查询name为“骆昊”或者tel为“13022223333”的文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s1">&#39;$or&#39;</span><span class="o">:</span> <span class="p">[{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;骆昊&#39;</span><span class="p">},</span> <span class="p">{</span><span class="nx">tel</span><span class="o">:</span> <span class="s1">&#39;13022223333&#39;</span><span class="p">}]},</span> <span class="p">{</span><span class="nx">_id</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">tel</span><span class="o">:</span> <span class="mi">1</span><span class="p">}).</span><span class="nx">pretty</span><span class="p">()</span>
<span class="p">{</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;骆昊&#34;</span><span class="p">,</span> <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13566778899&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;白元芳&#34;</span><span class="p">,</span> <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13022223333&#34;</span> <span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 查询学生文档跳过第1条文档只查1条文档
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">skip</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">pretty</span><span class="p">()</span>
<span class="p">{</span>
        <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;5b13c790006ad854460ee70c&#34;</span><span class="p">),</span>
        <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1002</span><span class="p">,</span>
        <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;王大锤&#34;</span><span class="p">,</span>
        <span class="s2">&#34;tel&#34;</span> <span class="o">:</span> <span class="s2">&#34;13012345678&#34;</span><span class="p">,</span>
        <span class="s2">&#34;gender&#34;</span> <span class="o">:</span> <span class="s2">&#34;男&#34;</span>
<span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 对查询结果进行排序(1表示升序，-1表示降序)
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span><span class="nx">_id</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">stuid</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">name</span><span class="o">:</span> <span class="mi">1</span><span class="p">}).</span><span class="nx">sort</span><span class="p">({</span><span class="nx">stuid</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="p">{</span> <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1003</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;白元芳&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1002</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;王大锤&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;stuid&#34;</span> <span class="o">:</span> <span class="mi">1001</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;骆昊&#34;</span> <span class="p">}</span>
<span class="o">&gt;</span> <span class="c1">// 在指定的一个或多个字段上创建索引
</span><span class="c1"></span><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">students</span><span class="p">.</span><span class="nx">ensureIndex</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="p">{</span>
        <span class="s2">&#34;createdCollectionAutomatically&#34;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&#34;numIndexesBefore&#34;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&#34;numIndexesAfter&#34;</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&#34;ok&#34;</span> <span class="o">:</span> <span class="mi">1</span>
<span class="p">}</span>
<span class="o">&gt;</span> 
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>使用MongoDB可以非常方便的配置数据复制，通过冗余数据来实现数据的高可用以及灾难恢复，也可以通过数据分片来应对数据量迅速增长的需求。关于MongoDB更多的操作可以查阅<a href="https://mongodb-documentation.readthedocs.io/en/latest/" target="_blank" rel="noopener noreffer">官方文档</a> ，同时推荐大家阅读Kristina Chodorow写的<a href="http://www.ituring.com.cn/book/1172" target="_blank" rel="noopener noreffer">《MongoDB权威指南》</a>。</p>
<h4 id="在python程序中操作mongodb">在Python程序中操作MongoDB</h4>
<p>可以通过pip安装pymongo来实现对MongoDB的操作。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Shell" data-lang="Shell">pip3 install pymongo
python3
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Python" data-lang="Python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="s1">&#39;mongodb://127.0.0.1:27017&#39;</span><span class="p">)</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">school</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">student</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">students</span><span class="o">.</span><span class="n">find</span><span class="p">():</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="s1">&#39;学号:&#39;</span><span class="p">,</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;stuid&#39;</span><span class="p">])</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="s1">&#39;姓名:&#39;</span><span class="p">,</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="s1">&#39;电话:&#39;</span><span class="p">,</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;tel&#39;</span><span class="p">])</span>
<span class="o">...</span> 
<span class="err">学号</span><span class="p">:</span> <span class="mf">1001.0</span>
<span class="err">姓名</span><span class="p">:</span> <span class="err">骆昊</span>
<span class="err">电话</span><span class="p">:</span> <span class="mi">13566778899</span>
<span class="err">学号</span><span class="p">:</span> <span class="mf">1002.0</span>
<span class="err">姓名</span><span class="p">:</span> <span class="err">王大锤</span>
<span class="err">电话</span><span class="p">:</span> <span class="mi">13012345678</span>
<span class="err">学号</span><span class="p">:</span> <span class="mf">1003.0</span>
<span class="err">姓名</span><span class="p">:</span> <span class="err">白元芳</span>
<span class="err">电话</span><span class="p">:</span> <span class="mi">13022223333</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">students</span><span class="o">.</span><span class="n">find</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">students</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">students</span><span class="o">.</span><span class="n">find</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">coll</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">students</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">ASCENDING</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">coll</span><span class="o">.</span><span class="n">create_index</span><span class="p">([(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">ASCENDING</span><span class="p">)],</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="s1">&#39;name_1&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">coll</span><span class="o">.</span><span class="n">insert_one</span><span class="p">({</span><span class="s1">&#39;stuid&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1001</span><span class="p">),</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;骆昊&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
<span class="o">&lt;</span><span class="n">pymongo</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">InsertOneResult</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x1050cc6c8</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">coll</span><span class="o">.</span><span class="n">insert_many</span><span class="p">([{</span><span class="s1">&#39;stuid&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1002</span><span class="p">),</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;王大锤&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;stuid&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1003</span><span class="p">),</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;白元芳&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}])</span>
<span class="o">&lt;</span><span class="n">pymongo</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">InsertManyResult</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x1050cc8c8</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">student</span> <span class="ow">in</span> <span class="n">coll</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}):</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="s1">&#39;学号:&#39;</span><span class="p">,</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;stuid&#39;</span><span class="p">])</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="s1">&#39;姓名:&#39;</span><span class="p">,</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="s1">&#39;性别:&#39;</span><span class="p">,</span> <span class="s1">&#39;男&#39;</span> <span class="k">if</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;女&#39;</span><span class="p">)</span>
<span class="o">...</span> 
<span class="err">学号</span><span class="p">:</span> <span class="mi">1001</span>
<span class="err">姓名</span><span class="p">:</span> <span class="err">骆昊</span>
<span class="err">性别</span><span class="p">:</span> <span class="err">男</span>
<span class="err">学号</span><span class="p">:</span> <span class="mi">1003</span>
<span class="err">姓名</span><span class="p">:</span> <span class="err">白元芳</span>
<span class="err">性别</span><span class="p">:</span> <span class="err">男</span>
<span class="o">&gt;&gt;&gt;</span> 
</code></pre></td></tr></table>
</div>
</div><p>关于PyMongo更多的知识可以通过它的<a href="https://api.mongodb.com/python/current/tutorial.html" target="_blank" rel="noopener noreffer">官方文档</a>进行了解，也可以使用<a href="https://pypi.org/project/mongoengine/" target="_blank" rel="noopener noreffer">MongoEngine</a>这样的库来简化Python程序对MongoDB的操作，除此之外，还有以异步I/O方式访问MongoDB的三方库<a href="https://pypi.org/project/motor/" target="_blank" rel="noopener noreffer">motor</a>都是不错的选择。</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2016-12-15</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/nosql%E5%85%A5%E9%97%A8/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="http://www.nishinonanase.xyz/nosql%E5%85%A5%E9%97%A8/" data-title="NoSQL入门" data-hashtags="数据库,Nosql"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://www.nishinonanase.xyz/nosql%E5%85%A5%E9%97%A8/" data-hashtag="数据库"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="http://www.nishinonanase.xyz/nosql%E5%85%A5%E9%97%A8/" data-title="NoSQL入门"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="http://www.nishinonanase.xyz/nosql%E5%85%A5%E9%97%A8/" data-title="NoSQL入门"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://www.nishinonanase.xyz/nosql%E5%85%A5%E9%97%A8/" data-title="NoSQL入门" data-ralateuid="5146819796"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="分享到 百度" data-sharer="baidu" data-url="http://www.nishinonanase.xyz/nosql%E5%85%A5%E9%97%A8/" data-title="NoSQL入门"><i data-svg-src="/lib/simple-icons/icons/baidu.min.svg"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>,&nbsp;<a href="/tags/nosql/">Nosql</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/mysql%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="prev" rel="prev" title="MySQL性能优化"><i class="fas fa-angle-left fa-fw"></i>MySQL性能优化</a>
            <a href="/redis%E6%8C%81%E4%B9%85%E5%8C%96/" class="next" rel="next" title="Redis持久化">Redis持久化<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由<a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.68.3">Hugo</a> 驱动 | 主题-<a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a> | 乃木坂46
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2016 - 2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://www.nishinonanase.xyz/" target="_blank">书兰</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a target="_blank" href="https://weibo.com/u/7266809683">欢迎微博关注@西野七瀬</a></span></div>
            
        </div>
    </footer><script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
<script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js"></script></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="https://cdn.example.com/some.css"><script type="text/javascript" src="/lib/valine/Valine.min.js"></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="https://cdn.example.com/some.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"valine":{"appId":"pYP10MBmXAHPlpAH6etQREAF-gzGzoHsz","appKey":"U85Rh0XAdTAh3amYgmCcv8no","avatar":"mm","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":true,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"你的评论 ...","recordIP":true,"visitor":true}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
